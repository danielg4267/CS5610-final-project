{"ast":null,"code":"import axios from 'axios';\nimport { findRecentReview, findRecentReviewByUserID } from \"./reviews-services\";\nimport { findUserByID } from \"./users-services\";\nimport { getBookDetailsByID } from \"./openlib-services\";\nconst API_BASE = 'http://localhost:4000/api';\nconst FOLLOW_API = `${API_BASE}/follow`;\nconst REVIEWS_API = `${API_BASE}/reviews`;\nconst api = axios.create({\n  withCredentials: true\n});\nexport const followUser = async uid => {\n  const result = await api.post(`${FOLLOW_API}/${uid}`);\n  return result.data;\n};\nexport const unfollowUser = async uid => {\n  const result = await api.delete(`${FOLLOW_API}/${uid}`);\n  return result.data;\n};\nexport const getFollowers = async uid => {\n  const result = await api.get(`${FOLLOW_API}/${uid}`);\n  console.log(`${FOLLOW_API}/${uid}`);\n  //console.log(result.data);\n  return result.data;\n};\nexport const getFollowing = async uid => {\n  const result = await api.get(`${FOLLOW_API}/following/${uid}`);\n  //console.log(`${FOLLOW_API}/following/${uid}`)\n  return result.data;\n};\nexport const getHighlightedReview = async following => {\n  let reviewInfo = null;\n  if (following) {\n    reviewInfo = await getRecentFollowedReview(following._id);\n  } else {\n    const review = await findRecentReview();\n    const user = await findUserByID(review[0].uid);\n    //For consistency's sake\n    reviewInfo = {\n      review: review[0],\n      user: {\n        _id: user._id,\n        username: user.username,\n        profilePic: user.profilePic\n      }\n    };\n  }\n  const bookInfo = await getBookDetailsByID(reviewInfo.review.bid);\n  return {\n    review: reviewInfo.review,\n    user: reviewInfo.user,\n    book: {\n      title: bookInfo.title,\n      cover: bookInfo.covers[0]\n    }\n  };\n};\nexport const getRecentFollowedReview = async following => {\n  const result = await getFollowing(following);\n  const review = {};\n  if (result.length > 0) {\n    const randomFollowed = result[Math.floor(Math.random() * result.length)];\n    const review = await findRecentReviewByUserID(randomFollowed.followed._id);\n    review.review = review[0];\n    review.user = randomFollowed.followed;\n  }\n  if (result.length > 0 || !review.review) {\n    const response = await api.get(`${REVIEWS_API}/recent/ne-user/${following}`);\n    console.log(response);\n    return null;\n  }\n};","map":{"version":3,"names":["axios","findRecentReview","findRecentReviewByUserID","findUserByID","getBookDetailsByID","API_BASE","FOLLOW_API","REVIEWS_API","api","create","withCredentials","followUser","uid","result","post","data","unfollowUser","delete","getFollowers","get","console","log","getFollowing","getHighlightedReview","following","reviewInfo","getRecentFollowedReview","_id","review","user","username","profilePic","bookInfo","bid","book","title","cover","covers","length","randomFollowed","Math","floor","random","followed","response"],"sources":["C:/Users/danie/Desktop/ALIGN MSCS Files/CS 5610 - Web Development/spring23/final-project/final-react-app/src/services/follow-services.js"],"sourcesContent":["import axios from 'axios';\r\nimport {findRecentReview, findRecentReviewByUserID} from \"./reviews-services\";\r\nimport {findUserByID} from \"./users-services\";\r\nimport {getBookDetailsByID} from \"./openlib-services\";\r\nconst API_BASE = 'http://localhost:4000/api'\r\nconst FOLLOW_API = `${API_BASE}/follow`;\r\nconst REVIEWS_API = `${API_BASE}/reviews`;\r\n\r\nconst api = axios.create({withCredentials: true})\r\n\r\nexport const followUser = async (uid) => {\r\n    const result = await api.post(`${FOLLOW_API}/${uid}`);\r\n    return result.data;\r\n}\r\n\r\nexport const unfollowUser = async (uid) => {\r\n    const result = await api.delete(`${FOLLOW_API}/${uid}`);\r\n    return result.data;\r\n}\r\n\r\nexport const getFollowers = async (uid) => {\r\n    const result = await api.get(`${FOLLOW_API}/${uid}`);\r\n    console.log(`${FOLLOW_API}/${uid}`)\r\n    //console.log(result.data);\r\n    return result.data;\r\n}\r\n\r\nexport const getFollowing = async (uid) => {\r\n    const result = await api.get(`${FOLLOW_API}/following/${uid}`);\r\n    //console.log(`${FOLLOW_API}/following/${uid}`)\r\n    return result.data;\r\n}\r\n\r\nexport const getHighlightedReview = async (following) => {\r\n    let reviewInfo = null;\r\n    if(following){\r\n        reviewInfo = await getRecentFollowedReview(following._id)\r\n    }\r\n    else{\r\n        const review = await findRecentReview();\r\n        const user = await findUserByID(review[0].uid);\r\n        //For consistency's sake\r\n        reviewInfo = {review: review[0], user:{_id: user._id, username: user.username, profilePic: user.profilePic}}\r\n    }\r\n\r\n    const bookInfo = await getBookDetailsByID(reviewInfo.review.bid);\r\n\r\n    return({\r\n        review: reviewInfo.review,\r\n        user: reviewInfo.user,\r\n        book: {title: bookInfo.title, cover: bookInfo.covers[0]}\r\n    })\r\n\r\n}\r\nexport const getRecentFollowedReview = async (following) => {\r\n    const result = await getFollowing(following);\r\n    const review = {}\r\n\r\n    if(result.length > 0){\r\n        const randomFollowed = result[Math.floor(Math.random() * result.length)];\r\n        const review = await findRecentReviewByUserID(randomFollowed.followed._id);\r\n        review.review = review[0];\r\n        review.user = randomFollowed.followed;\r\n    }\r\n    if(result.length > 0 || !review.review){\r\n        const response = await api.get(`${REVIEWS_API}/recent/ne-user/${following}`)\r\n        console.log(response);\r\n        return null;\r\n    }\r\n\r\n\r\n}\r\n"],"mappings":"AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAAQC,gBAAgB,EAAEC,wBAAwB,QAAO,oBAAoB;AAC7E,SAAQC,YAAY,QAAO,kBAAkB;AAC7C,SAAQC,kBAAkB,QAAO,oBAAoB;AACrD,MAAMC,QAAQ,GAAG,2BAA2B;AAC5C,MAAMC,UAAU,GAAI,GAAED,QAAS,SAAQ;AACvC,MAAME,WAAW,GAAI,GAAEF,QAAS,UAAS;AAEzC,MAAMG,GAAG,GAAGR,KAAK,CAACS,MAAM,CAAC;EAACC,eAAe,EAAE;AAAI,CAAC,CAAC;AAEjD,OAAO,MAAMC,UAAU,GAAG,MAAOC,GAAG,IAAK;EACrC,MAAMC,MAAM,GAAG,MAAML,GAAG,CAACM,IAAI,CAAE,GAAER,UAAW,IAAGM,GAAI,EAAC,CAAC;EACrD,OAAOC,MAAM,CAACE,IAAI;AACtB,CAAC;AAED,OAAO,MAAMC,YAAY,GAAG,MAAOJ,GAAG,IAAK;EACvC,MAAMC,MAAM,GAAG,MAAML,GAAG,CAACS,MAAM,CAAE,GAAEX,UAAW,IAAGM,GAAI,EAAC,CAAC;EACvD,OAAOC,MAAM,CAACE,IAAI;AACtB,CAAC;AAED,OAAO,MAAMG,YAAY,GAAG,MAAON,GAAG,IAAK;EACvC,MAAMC,MAAM,GAAG,MAAML,GAAG,CAACW,GAAG,CAAE,GAAEb,UAAW,IAAGM,GAAI,EAAC,CAAC;EACpDQ,OAAO,CAACC,GAAG,CAAE,GAAEf,UAAW,IAAGM,GAAI,EAAC,CAAC;EACnC;EACA,OAAOC,MAAM,CAACE,IAAI;AACtB,CAAC;AAED,OAAO,MAAMO,YAAY,GAAG,MAAOV,GAAG,IAAK;EACvC,MAAMC,MAAM,GAAG,MAAML,GAAG,CAACW,GAAG,CAAE,GAAEb,UAAW,cAAaM,GAAI,EAAC,CAAC;EAC9D;EACA,OAAOC,MAAM,CAACE,IAAI;AACtB,CAAC;AAED,OAAO,MAAMQ,oBAAoB,GAAG,MAAOC,SAAS,IAAK;EACrD,IAAIC,UAAU,GAAG,IAAI;EACrB,IAAGD,SAAS,EAAC;IACTC,UAAU,GAAG,MAAMC,uBAAuB,CAACF,SAAS,CAACG,GAAG,CAAC;EAC7D,CAAC,MACG;IACA,MAAMC,MAAM,GAAG,MAAM3B,gBAAgB,EAAE;IACvC,MAAM4B,IAAI,GAAG,MAAM1B,YAAY,CAACyB,MAAM,CAAC,CAAC,CAAC,CAAChB,GAAG,CAAC;IAC9C;IACAa,UAAU,GAAG;MAACG,MAAM,EAAEA,MAAM,CAAC,CAAC,CAAC;MAAEC,IAAI,EAAC;QAACF,GAAG,EAAEE,IAAI,CAACF,GAAG;QAAEG,QAAQ,EAAED,IAAI,CAACC,QAAQ;QAAEC,UAAU,EAAEF,IAAI,CAACE;MAAU;IAAC,CAAC;EAChH;EAEA,MAAMC,QAAQ,GAAG,MAAM5B,kBAAkB,CAACqB,UAAU,CAACG,MAAM,CAACK,GAAG,CAAC;EAEhE,OAAO;IACHL,MAAM,EAAEH,UAAU,CAACG,MAAM;IACzBC,IAAI,EAAEJ,UAAU,CAACI,IAAI;IACrBK,IAAI,EAAE;MAACC,KAAK,EAAEH,QAAQ,CAACG,KAAK;MAAEC,KAAK,EAAEJ,QAAQ,CAACK,MAAM,CAAC,CAAC;IAAC;EAC3D,CAAC;AAEL,CAAC;AACD,OAAO,MAAMX,uBAAuB,GAAG,MAAOF,SAAS,IAAK;EACxD,MAAMX,MAAM,GAAG,MAAMS,YAAY,CAACE,SAAS,CAAC;EAC5C,MAAMI,MAAM,GAAG,CAAC,CAAC;EAEjB,IAAGf,MAAM,CAACyB,MAAM,GAAG,CAAC,EAAC;IACjB,MAAMC,cAAc,GAAG1B,MAAM,CAAC2B,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG7B,MAAM,CAACyB,MAAM,CAAC,CAAC;IACxE,MAAMV,MAAM,GAAG,MAAM1B,wBAAwB,CAACqC,cAAc,CAACI,QAAQ,CAAChB,GAAG,CAAC;IAC1EC,MAAM,CAACA,MAAM,GAAGA,MAAM,CAAC,CAAC,CAAC;IACzBA,MAAM,CAACC,IAAI,GAAGU,cAAc,CAACI,QAAQ;EACzC;EACA,IAAG9B,MAAM,CAACyB,MAAM,GAAG,CAAC,IAAI,CAACV,MAAM,CAACA,MAAM,EAAC;IACnC,MAAMgB,QAAQ,GAAG,MAAMpC,GAAG,CAACW,GAAG,CAAE,GAAEZ,WAAY,mBAAkBiB,SAAU,EAAC,CAAC;IAC5EJ,OAAO,CAACC,GAAG,CAACuB,QAAQ,CAAC;IACrB,OAAO,IAAI;EACf;AAGJ,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}