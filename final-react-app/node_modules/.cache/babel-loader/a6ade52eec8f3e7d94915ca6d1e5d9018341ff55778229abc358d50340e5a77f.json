{"ast":null,"code":"import axios from 'axios';\nimport { findUserByID } from \"./users-services\";\nimport { getBookDetailsByID } from \"./openlib-services\";\nimport { getFollowing } from \"./follow-services\";\nconst API_BASE = 'http://localhost:4000/api';\nconst REVIEWS_API = `${API_BASE}/reviews`;\nconst api = axios.create({\n  withCredentials: true\n});\nexport const createReview = async review => {\n  const response = await api.post(REVIEWS_API, review);\n  return response.data;\n};\nexport const updateReview = async review => {\n  const response = await api.put(REVIEWS_API, review);\n  return response.data;\n};\nexport const deleteReview = async review => {\n  const response = await api.delete(`${REVIEWS_API}/${review._id}`);\n  return response.data;\n};\nexport const findReviewsByUserID = async uid => {\n  const response = await api.get(`${REVIEWS_API}/user/${uid}`);\n  return response.data;\n};\nexport const findReviewsByBookID = async bid => {\n  const response = await api.get(`${REVIEWS_API}/book/${bid}`);\n  return response.data;\n};\nexport const findRecentReviewByUserID = async uid => {\n  const response = await api.get(`${REVIEWS_API}/recent/user/${uid}`);\n  return response.data;\n};\nexport const findRecentReview = async () => {\n  const response = await api.get(`${REVIEWS_API}/recent`);\n  return response.data;\n};\nexport const getHighlightedReview = async following => {\n  let reviewInfo = null;\n  if (following) {\n    reviewInfo = await getRecentFollowedReview(following._id);\n  } else {\n    const review = await findRecentReview();\n    const user = await findUserByID(review[0].uid);\n    //For consistency's sake\n    reviewInfo = {\n      review: review[0],\n      user: {\n        _id: user._id,\n        username: user.username,\n        profilePic: user.profilePic\n      }\n    };\n  }\n  const bookInfo = await getBookDetailsByID(reviewInfo.review.bid);\n  return {\n    review: reviewInfo.review,\n    user: reviewInfo.user,\n    book: {\n      title: bookInfo.title,\n      cover: bookInfo.covers[0]\n    }\n  };\n};\nexport const getRecentFollowedReview = async following => {\n  const result = await getFollowing(following);\n  const review = {};\n  if (result.length > 0) {\n    const randomFollowed = result[Math.floor(Math.random() * result.length)];\n    const review = await findRecentReviewByUserID(randomFollowed.followed._id);\n    review.review = review[0];\n    review.user = randomFollowed.followed;\n  }\n  console.log(review);\n  if (result.length < 1 || !review.review) {\n    const response = await api.get(`${REVIEWS_API}/recent/ne-user/${following}`);\n    const reviewData = response.data[0];\n    const userData = await findUserByID(reviewData.uid);\n    review.review = reviewData;\n    //same structure as followed object, obv not rly necessary since it has all this info, but for consistency's sake\n    review.user = {\n      _id: userData._id,\n      username: userData.username,\n      profilePic: userData.profilePic\n    };\n  }\n  if (review.review && review.user) {\n    return review;\n  } else {\n    return null;\n  }\n};","map":{"version":3,"names":["axios","findUserByID","getBookDetailsByID","getFollowing","API_BASE","REVIEWS_API","api","create","withCredentials","createReview","review","response","post","data","updateReview","put","deleteReview","delete","_id","findReviewsByUserID","uid","get","findReviewsByBookID","bid","findRecentReviewByUserID","findRecentReview","getHighlightedReview","following","reviewInfo","getRecentFollowedReview","user","username","profilePic","bookInfo","book","title","cover","covers","result","length","randomFollowed","Math","floor","random","followed","console","log","reviewData","userData"],"sources":["C:/Users/danie/Desktop/ALIGN MSCS Files/CS 5610 - Web Development/spring23/final-project/final-react-app/src/services/reviews-services.js"],"sourcesContent":["import axios from 'axios';\r\nimport {findUserByID} from \"./users-services\";\r\nimport {getBookDetailsByID} from \"./openlib-services\";\r\nimport {getFollowing} from \"./follow-services\";\r\nconst API_BASE = 'http://localhost:4000/api'\r\nconst REVIEWS_API = `${API_BASE}/reviews`;\r\n\r\nconst api = axios.create({withCredentials: true})\r\n\r\nexport const createReview = async (review) => {\r\n    const response = await api.post(REVIEWS_API, review);\r\n    return response.data;\r\n}\r\n\r\nexport const updateReview = async (review) => {\r\n\r\n    const response = await api.put(REVIEWS_API, review);\r\n    return response.data;\r\n}\r\n\r\nexport const deleteReview = async (review) => {\r\n    const response = await api.delete(`${REVIEWS_API}/${review._id}`)\r\n    return response.data;\r\n}\r\n\r\nexport const findReviewsByUserID = async (uid) => {\r\n    const response = await api.get(`${REVIEWS_API}/user/${uid}`);\r\n    return response.data;\r\n}\r\n\r\nexport const findReviewsByBookID = async (bid) => {\r\n    const response = await api.get(`${REVIEWS_API}/book/${bid}`);\r\n    return response.data;\r\n}\r\n\r\nexport const findRecentReviewByUserID = async (uid) => {\r\n    const response = await api.get(`${REVIEWS_API}/recent/user/${uid}`)\r\n    return response.data\r\n}\r\n\r\nexport const findRecentReview = async () => {\r\n    const response = await api.get(`${REVIEWS_API}/recent`)\r\n    return response.data\r\n}\r\n\r\nexport const getHighlightedReview = async (following) => {\r\n    let reviewInfo = null;\r\n    if(following){\r\n        reviewInfo = await getRecentFollowedReview(following._id)\r\n    }\r\n    else{\r\n        const review = await findRecentReview();\r\n        const user = await findUserByID(review[0].uid);\r\n        //For consistency's sake\r\n        reviewInfo = {review: review[0], user:{_id: user._id, username: user.username, profilePic: user.profilePic}}\r\n    }\r\n\r\n\r\n    const bookInfo = await getBookDetailsByID(reviewInfo.review.bid);\r\n\r\n    return({\r\n        review: reviewInfo.review,\r\n        user: reviewInfo.user,\r\n        book: {title: bookInfo.title, cover: bookInfo.covers[0]}\r\n    })\r\n\r\n}\r\nexport const getRecentFollowedReview = async (following) => {\r\n\r\n    const result = await getFollowing(following);\r\n    const review = {};\r\n    if(result.length > 0){\r\n        const randomFollowed = result[Math.floor(Math.random() * result.length)];\r\n        const review = await findRecentReviewByUserID(randomFollowed.followed._id);\r\n        review.review = review[0];\r\n        review.user = randomFollowed.followed;\r\n\r\n    }\r\n    console.log(review);\r\n    if(result.length < 1 || !review.review){\r\n        const response = await api.get(`${REVIEWS_API}/recent/ne-user/${following}`)\r\n        const reviewData = response.data[0];\r\n        const userData = await findUserByID(reviewData.uid);\r\n        review.review = reviewData;\r\n        //same structure as followed object, obv not rly necessary since it has all this info, but for consistency's sake\r\n        review.user = {_id: userData._id, username: userData.username, profilePic: userData.profilePic}\r\n    }\r\n\r\n    if(review.review && review.user){return review;}\r\n    else{return null;}\r\n\r\n}"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}